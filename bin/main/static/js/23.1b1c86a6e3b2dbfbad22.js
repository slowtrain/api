webpackJsonp([23],{z7NQ:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={name:"APPSYSTEM",props:["showDialogFlagProp","data","labels"],data:function(){return{listGrid:{tableProps:{border:!1,stripe:!0,headerCellStyle:function(){return"font-family: sans-serif; font-size: 14px; color: #28313b; font-weight: bold; height:60px"}},currentPage:1,rowIndex:-1,pageProps:{pageSize:10,pageSizes:[10,15,20]},data:[],filters:[{prop:["ciId","classstructureNm","ciname","description","classstructureId"],value:""}],filteredData:[],selection:[],titles:[{prop:"chk",label:"chk",width:"30px"},{prop:"ciId",width:"150px"},{prop:"classstructureNm",width:"150px"},{prop:"ciname",width:"150px"},{prop:"description",width:"200"},{prop:"classstructureId",width:"100"}],currentData:{},total:0},orgId:"",showDialogFlag:!1,search:"",ciSelect:[]}},watch:{showDialogFlagProp:function(t){var e=this;this.showDialogFlag=t,setTimeout(function(){e.$refs.test.$refs.elTable.clearSelection()},200)},data:function(){this.listGrid.data=this.data}},methods:{initialize:function(){},handleCiSelectionChange:function(t){this.ciSelect=t},destroy:function(){this.listGrid.filters[0].value="",this.search=""},setFilters:function(){this.listGrid.filters[0].value=this.search},confirm:function(){this.$emit("confirm",this.ciSelect)},close:function(){this.$emit("close")}},created:function(){this.initialize()}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{title:t.labels.dialogTitle,visible:t.showDialogFlag,width:"700px"},on:{"update:visible":function(e){t.showDialogFlag=e},close:t.close}},[s("b-row",[s("b-col",[s("b-row",[s("b-col",{attrs:{sm:"12"}},[s("div",{staticClass:"search-component"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control mt-1",attrs:{placeholder:t.labels.search},domProps:{value:t.search},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setFilters(e)},input:function(e){e.target.composing||(t.search=e.target.value)}}})])])],1),t._v(" "),s("b-row",[s("b-col",{attrs:{sm:"12"}},[s("p",{staticClass:"grid-line"}),t._v(" "),s("data-tables",{ref:"test",staticStyle:{width:"100%"},attrs:{layout:"table, pagination","table-props":t.listGrid.tableProps,"page-size":t.listGrid.pageProps.pageSize,data:t.listGrid.data,filters:t.listGrid.filters,"pagination-props":t.listGrid.pageProps},on:{"selection-change":t.handleCiSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"60"}}),t._v(" "),s("el-table-column",{attrs:{prop:t.listGrid.titles[1].prop,label:t.labels.ciId,sortable:"custom",width:t.listGrid.titles[1].width}}),t._v(" "),s("el-table-column",{attrs:{prop:t.listGrid.titles[2].prop,label:t.labels.classstructureId,sortable:"custom",width:t.listGrid.titles[1].width}}),t._v(" "),s("el-table-column",{attrs:{prop:t.listGrid.titles[3].prop,label:t.labels.ciname,sortable:"custom",width:t.listGrid.titles[3].width}}),t._v(" "),s("el-table-column",{attrs:{prop:t.listGrid.titles[4].prop,label:t.labels.description,sortable:"custom"}})],1)],1)],1)],1)],1),t._v(" "),s("b-row",[s("div",{staticClass:"col mt-2"},[s("div",{staticClass:"d-flex justify-content-end"},[s("b-button",{staticClass:"px-3 sm",attrs:{variant:"primary"},on:{click:t.confirm}},[t._v(t._s(t.labels.confirm))]),t._v(" "),s("b-button",{staticClass:"px-3 sm",attrs:{variant:"primary"},on:{click:t.close}},[t._v(t._s(t.labels.close))])],1)])])],1)},staticRenderFns:[]},l=s("VU/8")(a,i,!1,null,null,null).exports,r=s("ikxi"),o=s.n(r),n=s("UlOv"),p=n.f.reactiveProp;o.a.defaults.LineWithLine=o.a.defaults.line,o.a.controllers.LineWithLine=o.a.controllers.line.extend({draw:function(t){if(o.a.controllers.line.prototype.draw.call(this,t),this.chart.tooltip._active&&this.chart.tooltip._active.length){var e=this.chart.tooltip._active[0],s=this.chart.ctx,a=e.tooltipPosition().x,i=this.chart.scales["y-axis-0"].top,l=this.chart.scales["y-axis-0"].bottom;s.save(),s.beginPath(),s.moveTo(a,i),s.lineTo(a,l),s.lineWidth=1,s.strokeStyle="#07C",s.stroke(),s.restore()}}});var c={extends:Object(n.e)("custom-line","LineWithLine"),mixins:[p],props:["options"],data:function(){return{}},mounted:function(){this.renderChart(this.chartData,this.options)},watch:{options:function(){this.$data._chart.update(),this.renderChart(this.chartData,this.options)}}},h={name:"SERVICEAPPCHART",props:["app","seleteDate","labels"],components:{LineChart:s("VU/8")(c,null,!1,null,null,null).exports},data:function(){return{qStyle:{height:"250px",width:"100%"},appChartFlag:!1,appData:{},appOption:{},chartColor:[],chartColor2:[]}},watch:{},methods:{initialize:function(){this.$util.isNull(this.app)||this.getE2EData(this.app)},getE2EData:function(t){var e=this;this.appChartFlag=!1,this.appData={};var s=this.$util.timestampDate(this.seleteDate[0]),a=this.$util.timestampDate(this.seleteDate[1]);this.$http.get("/episode/api/asset/servicemgmnt/serviceapp/appdata?app="+t+"&startDate="+s+"&endDate="+a).then(function(t){e.chartMake(t.data)}).catch(function(t){console.log(t)})},dateTime:function(t){return this.$util.dateTime(t)},chartMake:function(t){var e=this;if(this.appChartFlag=!0,0!==t.length&&!this.$util.isNull(t[0])){this.$util.getRgba(t,this.chartColor,this.chartColor2);var s=[];t[0].collDt.forEach(function(t){var e=t.substring(0,t.indexOf(".")),a=new Date(e);s.push(new Date(a))}),this.appData.labels=s,this.appData.datasets=[],t.forEach(function(t,s){var a=t.totalTime,i={pointRadius:0};i.label=t.ciId,i.borderColor=e.chartColor[s],i.borderWidth=1.5,i.backgroundColor=e.chartColor2[s],i.data=a,e.appData.datasets.push(i)})}this.appOption={responsive:!0,maintainAspectRatio:!1,hover:{mode:"label",intersect:!0},tooltips:{intersect:!1,mode:"index"},scales:{showLines:!1,xAxes:[{type:"time",time:{unit:"day",min:new Date(this.$util.getDateType(this.seleteDate[0])),max:new Date(this.$util.getDateType(this.seleteDate[1]))}}],yAxes:[{ticks:{min:0,callback:function(t){return t+" (s)"}},scaleLabel:{display:!0,labelString:this.labels.totalTime}}]}}}},mounted:function(){this.initialize()},beforeDestroy:function(){this.appData={},this.appOption={},this.chartColor=[],this.chartColor2=[],this.$nextTick(function(){this.appChartFlag=!1})}},d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"animated fadeIn"},[e("b-row",[e("b-col",{attrs:{sm:"12"}},[this.appChartFlag?e("line-chart",{style:this.qStyle,attrs:{"chart-data":this.appData,options:this.appOption}}):this._e()],1)],1)],1)},staticRenderFns:[]},u={name:"SERVICEAPP",components:{AppSystem:l,ServiceAppChart:s("VU/8")(h,d,!1,null,null,null).exports},data:function(){return{labels:{totalTime:"",lossCost:"",dialogTitle:"",date:"",ciId:"",ciname:"",search:"",confirm:"",close:"",orgId:"",title:"",excelDownload:"",noDataMessage:"",appMessage:"",noDateMessage:"",collDt:"",classstructureId:"",noAppMessage:"",selectNullMsg:""},seleteDate:[new Date((new Date).setDate((new Date).getDate()-7)),new Date],appList:[],selectedApp:[],selectedAppName:[],searchParam:"",selectionFlag:!0,showAppDialogFlag:!1,listGridFlag:!1,listGrid:{tableProps:{border:!1,stripe:!0,headerCellStyle:function(){return"font-family: sans-serif; font-size: 14px; color: #28313b; font-weight: bold; height:60px"}},currentPage:1,rowIndex:-1,pageProps:{pageSize:5,pageSizes:[5,10,15]},data:[],dataBak:[],filters:[{prop:["collDt","ciId","classstructureNm","ciname","totalTime","lossCost","classstructureId"],value:""},{prop:["appList"],value:[]},{prop:["seleteDate"],value:""}],filteredData:[],titles:[{prop:"collDt",width:"220px"},{prop:"ciId",width:"200px"},{prop:"classstructureNm",width:"250px"},{prop:"ciname",width:"200px"},{prop:"totalTime",width:"200px"},{prop:"lossCost",width:"200px"},{prop:"classstructureId",width:"200px"}],columns:["collDt","ciId","classstructureNm","ciname","totalTime","lossCost"],columnNames:["collDt","ciId","classstructureNm","ciname","totalTime","lossCost"],currentData:{},total:0}}},props:{confirmResult:{type:Boolean}},computed:{lossCostFormat:function(){return function(t){return"ï¿¦ "+t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}}},methods:{initialize:function(){this.$util.setLabels(this.$options.name,this.labels),this.getApp(),this.selectedApp=[],this.selectedAppName=[],this.listGridFlag=!0},blurData:function(){var t=this,e=this.$util.timestampDate(this.seleteDate[0]),s=this.$util.timestampDate(this.seleteDate[1]);this.$http.get("/episode/api/asset/servicemgmnt/serviceapp/app?startDate="+e+"&endDate="+s).then(function(e){t.selectedApp=[],t.selectedAppName=[],t.appList=e.data}).catch(function(t){console.log(t)})},getApp:function(){var t=this,e=this.$util.timestampDate(this.seleteDate[0]),s=this.$util.timestampDate(this.seleteDate[1]);this.$http.get("/episode/api/asset/servicemgmnt/serviceapp/app?startDate="+e+"&endDate="+s).then(function(e){t.appList=e.data,e.data.forEach(function(e){t.selectedApp.push(e.ciId),t.selectedAppName.push(e.ciname)}),0!==t.selectedApp.length&&t.setFilters()}).catch(function(t){console.log(t)})},enterSearch:function(){this.listGrid.currentPage=1,this.listGrid.filters[0].value=this.searchParam},setFilters:function(){if(this.$util.isNull(this.seleteDate))this.$util.esmessage(this,"warn",this.labels.noDateMessage);else{if(0===this.selectedApp.length)return this.$util.esmessage(this,"warn",this.labels.appMessage),null;this.listGrid.filters[1].value=this.selectedApp,this.listGrid.filters[2].value=this.seleteDate,this.$refs.appchart.initialize()}},getAppList:function(t){var e=this,s=this.$store.getters.getOrgvariable.filter(function(t){return"AVG_WAGE_RATE"===t.key}),a="";0!==s.length&&(a=parseInt(s[0].value));var i=this.$util.timestampDate(this.seleteDate[0]),l=this.$util.timestampDate(this.seleteDate[1]),r=1,o=10,n="collDt",p="descending",c="",h="";this.$util.isNull(t)||(r=t.page,o=t.pageSize,null!=t.sort.prop&&(n=t.sort.prop,p=t.sort.order),c=t.filters[0].value.trim(),h=t.filters[1].value);var d={params:{page:r,pageSize:o,orderBy:n,sort:p,searchParam:c,startDate:i,endDate:l,app:h.join(","),avgWageRate:a}};this.$http.get("/episode/api/asset/servicemgmnt/serviceapp",d).then(function(t){e.listGrid.data=t.data.data,e.listGrid.total=t.data.total}).catch(function(t){console.log(t)})},handleFilteredData:function(t){this.listGrid.filteredData=t},openAppDialog:function(){if(0===this.appList.length)return this.$util.esmessage(this,"warn",this.labels.noAppMessage),!1;this.showAppDialogFlag=!0},confirmApp:function(t){var e=this;0!==t.length?(this.selectedApp=[],this.selectedAppName=[],this.showAppDialogFlag=!1,t.forEach(function(t){e.selectedApp.push(t.ciId),e.selectedAppName.push(t.ciname)})):this.$util.esmessage(this,"warn",this.labels.selectNullMsg)},closeAppDialog:function(){this.showAppDialogFlag=!1},exportFilter:function(){var t=this,e=this.$store.getters.getOrgvariable,s=parseInt(e.filter(function(t){return"AVG_WAGE_RATE"===t.key})[0].value),a={params:{orderBy:"collDt",sort:"descending",searchParam:this.listGrid.filters[0].value,startDate:this.$util.timestampDate(this.seleteDate[0]),endDate:this.$util.timestampDate(this.seleteDate[1]),app:this.listGrid.filters[1].value.join(","),avgWageRate:s}};this.$http.get("/episode/api/asset/servicemgmnt/serviceapp",a).then(function(e){var s=t.$store.getters.getUser.lang,a="serviceApp",i=[{value:"collDt",label:t.labels.collDt},{value:"ciId",label:t.labels.ciId},{value:"ciname",label:t.labels.ciname},{value:"classstructureId",label:t.labels.classstructureId},{value:"totalTime",label:t.labels.totalTime},{value:"lossCost",label:t.labels.lossCost}];"ko-kr"===s&&(a=t.labels.title),0!==e.data.total?t.$util.csvExport(e.data.data,i,t.listGrid.columnNames,a):t.$util.esmessage(t,"warn",t.labels.noDataMessage)}).catch(function(t){console.log(t)})},dateTime:function(t){return this.$util.dateTime(t)}},created:function(){this.initialize()},beforeDestroy:function(){this.listGrid.data=[],this.seleteDate=[],this.appList=[],this.selectedApp=[],this.selectedAppName=[],this.labels={},this.$nextTick(function(){this.listGridFlag=!1})}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"animated fadeIn"},[a("b-card",[a("b-row",[a("b-col",{attrs:{sm:"4"}},[a("el-form",{attrs:{"label-position":"top","label-width":"100px"}},[a("el-form-item",{attrs:{label:t.labels.date}},[a("div",{staticClass:"search-component"},[a("el-date-picker",{staticClass:"form-control mt-1",staticStyle:{width:"100%"},attrs:{type:"daterange",clearable:!1},on:{blur:t.blurData},model:{value:t.seleteDate,callback:function(e){t.seleteDate=e},expression:"seleteDate"}})],1)])],1)],1),t._v(" "),a("b-col",{attrs:{sm:"3"}},[a("el-form",{attrs:{"label-position":"top","label-width":"100px"}},[a("el-form-item",{attrs:{label:t.labels.system}},[a("div",{staticClass:"search-component"},[a("input",{staticClass:"form-control mt-1",staticStyle:{"background-color":"white"},attrs:{readonly:""}}),t._v(" "),a("div",{staticClass:"el-select__tags",staticStyle:{"margin-left":"7px"}},[a("span",[a("span",{directives:[{name:"show",rawName:"v-show",value:t.selectedAppName.length>0,expression:"selectedAppName.length > 0"}],staticClass:"el-tag--info",staticStyle:{padding:"0px 7px 0px 7px"}},[t._v(t._s(t.selectedAppName[0]))]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.selectedAppName.length>1,expression:"selectedAppName.length > 1"}],staticClass:"el-tag--info",staticStyle:{padding:"0px 7px 0px 7px"}},[t._v(" "+t._s("+"+(t.selectedAppName.length-1))+" ")])])]),t._v(" "),a("a",{staticClass:"search-button cursor-pointer",staticStyle:{top:"7px"},on:{click:t.openAppDialog}},[t._v("search")])])])],1)],1),t._v(" "),a("b-col",{attrs:{sm:"2"}},[a("div",{staticStyle:{"margin-top":"40px"}},[a("b-button",{staticClass:"px-3 sm",staticStyle:{backgroundColor:"white",color:"#606266","font-weight":"bolder"},on:{click:function(e){return t.setFilters()}}},[t._v(t._s(this.labels.search))])],1)])],1),t._v(" "),a("b-row",[a("b-col",{attrs:{sm:"12"}},[a("p",{staticClass:"chart-line"}),t._v(" "),a("ServiceAppChart",{ref:"appchart",attrs:{app:t.selectedApp,seleteDate:t.seleteDate,labels:t.labels}})],1)],1),t._v(" "),a("b-row",[a("b-col",{attrs:{sm:"12"}},[a("p",{staticClass:"chart-line"}),t._v(" "),a("b-row",[a("b-col",{attrs:{sm:"6"}},[a("div",{staticClass:"search-component"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchParam,expression:"searchParam"}],staticClass:"form-control mt-1",staticStyle:{width:"80%"},attrs:{placeholder:t.labels.search},domProps:{value:t.searchParam},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.enterSearch(e)},input:function(e){e.target.composing||(t.searchParam=e.target.value)}}})])]),t._v(" "),a("b-col",{attrs:{sm:"6"}},[a("div",{staticClass:"float-right mb-1",attrs:{role:"group"}},[a("el-button",{staticStyle:{padding:"0 0 0 0",width:"40px",height:"40px"},attrs:{title:t.labels.excelDownload},on:{click:t.exportFilter}},[a("img",{attrs:{src:s("QOY8"),width:"60%"}})])],1)])],1),t._v(" "),a("b-row",[a("b-col",{attrs:{sm:"12"}},[a("p",{staticClass:"grid-line"}),t._v(" "),t.listGridFlag?a("data-tables-server",{ref:"grid",attrs:{"current-page":t.listGrid.currentPage,"table-props":t.listGrid.tableProps,data:t.listGrid.data,filters:t.listGrid.filters,total:t.listGrid.total,"page-size":t.listGrid.pageProps.pageSize,"pagination-props":{pageSizes:[5,10,15]}},on:{"update:currentPage":function(e){return t.$set(t.listGrid,"currentPage",e)},"update:current-page":function(e){return t.$set(t.listGrid,"currentPage",e)},"query-change":t.getAppList,"filtered-data":t.handleFilteredData}},[a("el-table-column",{attrs:{prop:t.listGrid.titles[0].prop,label:t.labels.collDt,sortable:"custom",width:t.listGrid.titles[0].width},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.dateTime(e.row.collDt)))]}}],null,!1,167008801)}),t._v(" "),a("el-table-column",{attrs:{prop:t.listGrid.titles[1].prop,label:t.labels.ciId,sortable:"custom",width:t.listGrid.titles[1].width}}),t._v(" "),a("el-table-column",{attrs:{prop:t.listGrid.titles[2].prop,label:t.labels.classstructureId,sortable:"custom",width:t.listGrid.titles[3].width}}),t._v(" "),a("el-table-column",{attrs:{prop:t.listGrid.titles[3].prop,label:t.labels.ciname,sortable:"custom"}}),t._v(" "),a("el-table-column",{attrs:{prop:t.listGrid.titles[4].prop,label:t.labels.totalTime,sortable:"custom",width:t.listGrid.titles[4].width}}),t._v(" "),a("el-table-column",{attrs:{prop:t.listGrid.titles[5].prop,label:t.labels.lossCost,sortable:"custom",width:t.listGrid.titles[5].width},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.lossCostFormat(e.row.lossCost)))]}}],null,!1,984865215)})],1):t._e()],1)],1)],1)],1)],1),t._v(" "),a("AppSystem",{ref:"appDialog",attrs:{showDialogFlagProp:t.showAppDialogFlag,data:t.appList,labels:t.labels},on:{confirm:t.confirmApp,close:t.closeAppDialog}})],1)},staticRenderFns:[]},g=s("VU/8")(u,m,!1,null,null,null);e.default=g.exports}});
//# sourceMappingURL=23.1b1c86a6e3b2dbfbad22.js.map